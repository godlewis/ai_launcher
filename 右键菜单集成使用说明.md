# AI启动器右键菜单集成使用说明

## 功能介绍
AI启动器右键菜单集成功能让您可以在任意文件夹上右键点击，选择"用AI工具打开"来快速启动AI工具，并自动在该目录下工作。

## 文件说明
- `registry_manager.exe` - 右键菜单注册与卸载程序
- `ai_launcher.exe` - AI工具启动器（主程序）

## 安装和使用

### 1. 注册右键菜单
1. 确保以管理员身份运行
   ```bash
   # 方法一：右键点击 registry_manager.exe → "以管理员身份运行"
   # 方法二：双击运行，程序会自动请求管理员权限
   ```

2. 在弹出的窗口中点击"注册右键菜单"按钮

3. 等待注册成功的提示信息

### 2. 使用右键菜单
1. 在任意文件夹上右键点击
2. 在右键菜单中找到"用AI工具打开"选项
3. 点击该选项，AI启动器会在该目录下启动
4. 选择需要的AI工具（Claude、Qwen、Codex）

### 3. 卸载右键菜单
1. 以管理员身份运行 `registry_manager.exe`
2. 点击"卸载右键菜单"按钮
3. 等待卸载成功的提示信息

## 技术细节

### 注册表位置
右键菜单信息会注册到以下位置：
- `HKEY_CLASSES_ROOT\Directory\shell\AITools`

### 启动命令
注册的启动命令格式：
```
"[ai_launcher.exe完整路径]" "%1"
```
其中 `%1` 会被替换为用户右键点击的目录路径。

### 权限要求
- 注册和卸载需要管理员权限
- 使用右键菜单不需要特殊权限

## 常见问题

### Q: 为什么需要管理员权限？
A: 注册表操作需要写入系统注册表，这需要管理员权限。

### Q: 右键菜单没有显示怎么办？
A:
1. 确保注册操作成功完成
2. 重启Windows资源管理器（或重新登录）
3. 检查杀毒软件是否阻止了注册表修改

### Q: 移动了ai_launcher.exe文件位置怎么办？
A:
1. 卸载当前的右键菜单
2. 将ai_launcher.exe移动到新位置
3. 重新注册右键菜单

### Q: 如何知道右键菜单是否已注册？
A: 运行registry_manager.exe，界面上会显示当前注册状态。

### Q: 在哪些系统上可以使用？
A: 支持Windows 7及更高版本，主要针对Windows 10企业版优化。

## 故障排除

### 注册失败
1. 确保以管理员身份运行
2. 检查ai_launcher.exe是否在同一目录
3. 暂时关闭杀毒软件重试
4. 检查系统注册表是否被保护

### 右键菜单不工作
1. 重新注册右键菜单
2. 重启Windows资源管理器
3. 检查ai_launcher.exe路径是否正确

### 卸载不完整
1. 手动删除注册表项：
   ```
   HKEY_CLASSES_ROOT\Directory\shell\AITools
   ```
2. 重启Windows资源管理器

## 安全说明
- 程序仅修改标准Windows Shell集成注册表项
- 不会修改系统关键设置
- 提供完整的卸载功能
- 遵循Windows Shell集成最佳实践

## 版本信息
- 版本：1.0.0
- 开发语言：C++ (Win32 API)
- 目标系统：Windows 10企业版（兼容Windows 7+）